<?xml version="1.0" encoding="UTF-8"?>
<ChatRoom id="village" xmlns:xi="http://www.w3.org/2001/XInclude" startX="1300" startY="600">

	<xi:include href="includes/room_config.xml"/>
		
	<CollisionMap id="walkableArea" assetID="hit_asset" />

	<Filters id="playerFilters">
		<DepthFilter id="playerDepthFilter" scaleBack="0.3" scaleFront="0.7"/>
	</Filters>
	
	<Sounds target="{Room.player}" id="sounds">
		<StreamingSound id="room_music" url="sounds/theme_music.mp3" play="true" looping="true" />
	</Sounds>

	<Scene id="scene" target="{Room.player}" viewportWidth="1024" viewportHeight="768" width="1500" height="900">
		
		<ParallaxLayer id="sky_layer" mouseEnabled="false" xm="0.4" ym="0.4">
			<DisplayObject2D id="sky" assetID="sky_asset" mouseEnabled="false"/>
		</ParallaxLayer>
		
		<ParallaxLayer id="far_layer" mouseEnabled="false" xm="0.8" ym="0.8">
			<DisplayObject2D id="far_trees" assetID="far_trees_asset" x="0" y="78" />
		</ParallaxLayer>
		
		<ParallaxLayer id="mid_layer" mouseEnabled="false" xm="0.9" ym="0.9">
			<DisplayObject2D id="mid_trees" assetID="mid_trees_asset" x="131" y="135" />
		</ParallaxLayer>
	
		<DisplayObject2D id="background" assetID="background_asset" mouseEnabled="false"/>
		<DisplayObject2D id="click" assetID="click_asset" mouseEnabled="true" clickThrough="true" alpha="0"/>
	 
		<ZSortingDisplayObject id="furniture">
			<DisplayObject2D id="well" assetID="well_asset" x="1247" y="({Room.well.originY}+{429})" originY="140" mouseEnabled="true" useHandCursor="true" scale="0.95"/>
			<DisplayObject2D id="house" assetID="house_asset" x="1003" y="({Room.house.originY}+{144})" originX="269" originY="354" />
			<DisplayObject2D id="window" assetID="window_asset" x="867" y="({Room.window.originY}+{375})" originY="154" />
			<DisplayObject2D id="egg" assetID="egg_asset" x="630" y="({Room.egg.originY}+{486})" originX="43" originY="55" mouseEnabled="true" useHandCursor="true"/>
			<DisplayObject2D id="sign" assetID="sign_asset" x="151" y="({Room.sign.originY}+{536})" originX="74" originY="211" />
			<DisplayObject2D id="mushroom_10" assetURL="images/beanstalk/mushroom_10.png" x="1384" y="({Room.mushroom_10.originY}+{725})" originX="71" originY="121" mouseEnabled="true" useHandCursor="true"/>
			<DisplayObject2D id="mushroom_9" assetURL="images/beanstalk/mushroom_9.png" x="847" y="({Room.mushroom_9.originY}+{724})" originX="33" originY="58" mouseEnabled="true" useHandCursor="true"/>
			<DisplayObject2D id="mushroom_8" assetURL="images/beanstalk/mushroom_8.png" x="1481" y="({Room.mushroom_8.originY}+{576})" originX="12" originY="19" mouseEnabled="true" useHandCursor="true"/>
			<DisplayObject2D id="mushroom_7" assetURL="images/beanstalk/mushroom_7.png" x="1464" y="({Room.mushroom_7.originY}+{546})" originX="28" originY="46" mouseEnabled="true" useHandCursor="true"/>
			<DisplayObject2D id="mushroom_6" assetURL="images/beanstalk/mushroom_6.png" x="1416" y="({Room.mushroom_6.originY}+{565})" originX="17" originY="29" mouseEnabled="true" useHandCursor="true"/>
			<DisplayObject2D id="mushroom_5" assetURL="images/beanstalk/mushroom_5.png" x="600" y="({Room.mushroom_5.originY}+{530})" originX="12" originY="20" mouseEnabled="true" useHandCursor="true"/>
			<DisplayObject2D id="mushroom_4" assetURL="images/beanstalk/mushroom_4.png" x="582" y="({Room.mushroom_4.originY}+{500})" originX="28" originY="43" mouseEnabled="true" useHandCursor="true"/>
			<DisplayObject2D id="mushroom_3" assetURL="images/beanstalk/mushroom_3.png" x="534" y="({Room.mushroom_3.originY}+{519})" originX="17" originY="29" mouseEnabled="true" useHandCursor="true"/>
			<DisplayObject2D id="mushroom_2" assetURL="images/beanstalk/mushroom_2.png" x="176" y="({Room.mushroom_2.originY}+{698})" originX="25" originY="41" mouseEnabled="true" useHandCursor="true"/>
			<DisplayObject2D id="mushroom_1" assetURL="images/beanstalk/mushroom_1.png" x="125" y="({Room.mushroom_1.originY}+{699})" originX="30" originY="56" mouseEnabled="true" useHandCursor="true"/>
			<DisplayObject2D id="stump" assetID="stump_asset" x="1006" y="({Room.stump.originY}+{648})" originX="88" originY="132" />
			<DisplayObject2D id="bridge_front" assetID="bridge_front_asset" x="333" y="789" originY="230" />
			<DisplayObject2D id="bridge_back" assetID="bridge_back_asset" x="277" y="635" originY="96" />
			<DisplayObject2D id="flowers_4" assetID="flowers_4_asset" x="873" y="767" originX="42" originY="63" />
			<DisplayObject2D id="flowers_3" assetID="flowers_3_asset" x="781" y="954" originX="156" originY="172" />
			<DisplayObject2D id="flowers_2" assetID="flowers_2_asset" x="128" y="677" originX="35" originY="60" />
			<DisplayObject2D id="flowers_1" assetID="flowers_1_asset" x="226" y="926" originX="147" originY="178" />
			<DisplayObject2D id="beanstalk" assetURL="images/beanstalk/beanstalk.swf" x="130" y="525" originY="565" />
			<DisplayObject2D id="fish" assetURL="images/beanstalk/fish.swf" x="610" y="720" originY="0" />
		</ZSortingDisplayObject>
		
		<DisplayObject2D id="coll" assetID="coll_1_asset" x="912" y="517" collidable="true" distance="170" alpha="0"/>
		
		<ParallaxLayer id="front_layer" mouseEnabled="false" xm="1.2" ym="1">
			<DisplayObject2D id="foreground_tree_3" assetID="foreground_tree_3_asset" x="1160" y="0" />
			<DisplayObject2D id="foreground_tree_2" assetID="foreground_tree_2_asset" x="859" y="0" />
			<DisplayObject2D id="foreground_tree_1" assetID="foreground_tree_1_asset" x="0" y="0" />
			<DisplayObject2D id="fore_left" assetID="fore_left_asset" x="0" y="709" />
			<DisplayObject2D id="fore_right" assetID="fore_right_asset" x="712" y="555" />
		</ParallaxLayer>
		
		<ZSortingDisplayObject id="playerMessages"/>
	</Scene>
	
	<Assets>
        <Asset id="hit_asset" url="images/beanstalk/hit.png"/>
        <Asset id="click_asset" url="images/beanstalk/click.png"/>
        <Asset id="light_filter_asset" url="images/beanstalk/light.jpg"/>		
		<Asset id="background_asset" url="images/beanstalk/background.png"/>
		<Asset id="sky_asset" url="images/beanstalk/sky.jpg" />	
		<Asset id="far_trees_asset" url="images/beanstalk/far_trees.png" />
		<Asset id="mid_trees_asset" url="images/beanstalk/mid_trees.png" />
		<Asset id="well_asset" url="images/beanstalk/well.swf" />
		<Asset id="house_asset" url="images/beanstalk/house.png" />
		<Asset id="window_asset" url="images/beanstalk/windows.swf" />
		<Asset id="beanstalk_asset" url="images/beanstalk/beanstalk.png" />
		<Asset id="egg_asset" url="images/beanstalk/egg.png" />
		<Asset id="sign_asset" url="images/beanstalk/sign.png" />
		<Asset id="mushroom_10_asset" url="images/beanstalk/mushroom_10.png" />
		<Asset id="mushroom_9_asset" url="images/beanstalk/mushroom_9.png" />
		<Asset id="mushroom_8_asset" url="images/beanstalk/mushroom_8.png" />
		<Asset id="mushroom_7_asset" url="images/beanstalk/mushroom_7.png" />
		<Asset id="mushroom_6_asset" url="images/beanstalk/mushroom_6.png" />
		<Asset id="mushroom_5_asset" url="images/beanstalk/mushroom_5.png" />
		<Asset id="mushroom_4_asset" url="images/beanstalk/mushroom_4.png" />
		<Asset id="mushroom_3_asset" url="images/beanstalk/mushroom_3.png" />
		<Asset id="mushroom_2_asset" url="images/beanstalk/mushroom_2.png" />
		<Asset id="mushroom_1_asset" url="images/beanstalk/mushroom_1.png" />
		<Asset id="stump_asset" url="images/beanstalk/stump.png" />
		<Asset id="bridge_front_asset" url="images/beanstalk/bridge_front.png" />
		<Asset id="bridge_back_asset" url="images/beanstalk/bridge_back.png" />
		<Asset id="flowers_4_asset" url="images/beanstalk/flowers_4.png" />
		<Asset id="flowers_3_asset" url="images/beanstalk/flowers_3.png" />
		<Asset id="flowers_2_asset" url="images/beanstalk/flowers_2.png" />
		<Asset id="flowers_1_asset" url="images/beanstalk/flowers_1.png" />
		<Asset id="foreground_tree_3_asset" url="images/beanstalk/foreground_tree_3.png" />
		<Asset id="foreground_tree_2_asset" url="images/beanstalk/foreground_tree_2.png" />
		<Asset id="foreground_tree_1_asset" url="images/beanstalk/foreground_tree_1.png" />
		<Asset id="fore_left_asset" url="images/beanstalk/fore_left.png" />
		<Asset id="fore_right_asset" url="images/beanstalk/fore_right.png" />
		<Asset id="coll_1_asset" url="images/beanstalk/coll_1.png" />
	</Assets>	
	
	<Triggers>
		<onFixup>
			<Call behaviourID="playFish" delay="({3000}~{7000})" />
		</onFixup>
	</Triggers>
	
	<Trigger gameObject="{Room.click}" event="onClick">
		<MoveTo gameObject="{Room.player}" targetX="{Event.x}" targetY="{Event.y}" />
	</Trigger>
	
	<Trigger gameObject="{Room.egg}" event="onClick">
		<GotoAndPlay gameObject="{Room.beanstalk}" frame="2"/>
		<SetValues target="{Room.egg}" mouseEnabled="false" useHandCursor="false" />
	</Trigger>
	
	<Trigger gameObject="{Room.well}" event="onClick">
		<GotoAndPlay gameObject="{Room.well}" frame="2"/>
		<SetValues target="{Room.well}" mouseEnabled="false" useHandCursor="false" />
		<SetValues target="{Room.well}" mouseEnabled="true" useHandCursor="true" delay="3000"/>
	</Trigger>
	
	<GameObject id="collisionStatus" insideCollision="false" canPlay="true"/>
	
	<Trigger gameObject="{Room.coll}" event="onEnterCollision">
		<GotoAndPlay gameObject="{Room.window}" frame="2" if="({Room.collisionStatus.canPlay}=={true})"/>
		<Call behaviourID="playAgain" if="({Room.collisionStatus.canPlay}=={false})"/>
	</Trigger>
	
	<Trigger gameObject="{Room.coll}" event="onExitCollision">
		<SetValues target="{Room.collisionStatus}" canPlay="false"/>
		<GotoAndPlay gameObject="{Room.window}" frame="75" />
		<SetValues target="{Room.collisionStatus}" canPlay="true" delay="1000"/>
	</Trigger>
	
	 <Trigger gameObject="{Room.mushroom_1}" event="onClick">
		<Alert message="{Event.handler.id}" />	 
	 </Trigger>
	
	 <Trigger gameObject="{Room.mushroom_2}" event="onClick">
		<Alert message="{Event.handler.id}" />	 
	 </Trigger>
	
	 <Trigger gameObject="{Room.mushroom_3}" event="onClick">
		<Alert message="{Event.handler.id}" />	 
	 </Trigger>
	
	 <Trigger gameObject="{Room.mushroom_4}" event="onClick">
		<Alert message="{Event.handler.id}" />	 
	 </Trigger>
	
	 <Trigger gameObject="{Room.mushroom_5}" event="onClick">
		<Alert message="{Event.handler.id}" />	 
	 </Trigger>
	
	 <Trigger gameObject="{Room.mushroom_6}" event="onClick">
		<Alert message="{Event.handler.id}" />	 
	 </Trigger>
	
	 <Trigger gameObject="{Room.mushroom_7}" event="onClick">
		<Alert message="{Event.handler.id}" />	 
	 </Trigger>
	
	 <Trigger gameObject="{Room.mushroom_8}" event="onClick">
		<Alert message="{Event.handler.id}" />	 
	 </Trigger>
	
	 <Trigger gameObject="{Room.mushroom_9}" event="onClick">
		<Alert message="{Event.handler.id}" />	 
	 </Trigger>
	
	 <Trigger gameObject="{Room.mushroom_10}" event="onClick">
		<Alert message="{Event.handler.id}" />	 
	 </Trigger>

	<BehaviourDefinition id="playAgain">
		<GotoAndPlay gameObject="{Room.window}" frame="2" if="({Room.collisionStatus.canPlay}=={true})"/>
		<Call behaviourID="playAgain" if="({Room.collisionStatus.canPlay}=={false})" delay="500"/>
	</BehaviourDefinition>

	<BehaviourDefinition id="playFish">
		<GotoAndPlay gameObject="{Room.fish}" frame="2"/>
		<Call behaviourID="playFish" delay="({3000}~{7000})" />
	</BehaviourDefinition>
	
</ChatRoom>	